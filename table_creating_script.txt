CREATE TABLE SUBSCRIPTIONS
(
    SUBSCRIPTIONID   NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    SUBSCRIPTIONTYPE VARCHAR2(50) NOT NULL,
    STARTDATE      DATE         NOT NULL,
    ENDDATE        DATE,
    STATUS         VARCHAR2(20) DEFAULT 'Active' CHECK (STATUS IN ('Active', 'Inactive'))
);

CREATE SEQUENCE SUBSCRIPTIONS_SEQ
START WITH 1
INCREMENT BY 1
NOCACHE;

CREATE TABLE CUSTOMERS
(
    CUSTOMERID       NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    NAME             VARCHAR(30)          NOT NULL,
    PHONENUMBER      VARCHAR2(11)         NOT NULL,
    EMAIL            VARCHAR2(100) UNIQUE NOT NULL,
    SUBSCRIPTIONSTATUS CHAR(3) DEFAULT 'No' CHECK (SUBSCRIPTIONSTATUS IN ('Yes', 'No')),
    SUBSCRIPTIONID     NUMBER
);

ALTER TABLE CUSTOMERS
ADD CONSTRAINT FK_MEMBERSHIP
FOREIGN KEY (SUBSCRIPTIONID) REFERENCES SUBSCRIPTIONS (SUBSCRIPTIONID);


CREATE TABLE PROFILES(
    PROFILEID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    CUSTOMERID NUMBER UNIQUE,
    AGE NUMBER CHECK(AGE > 16 AND AGE < 100),
    HEIGHT NUMBER(5,2) CHECK(HEIGHT > 0),
    WEIGHT NUMBER (5,2) CHECK (WEIGHT > 0),
    CONSTRAINT FK_CUSTOMER_PROFILE FOREIGN KEY (CUSTOMERID) REFERENCES CUSTOMERS(CUSTOMERID)
);

CREATE SEQUENCE profile_id_seq
    START WITH 1
    INCREMENT BY 1
    NOCACHE;


CREATE TABLE TRAINERS
(
    TRAINERID      NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    TRAINER_NAME           VARCHAR(50)  NOT NULL,
    SPECIALIZATION VARCHAR(30)  NOT NULL,
    TRAINER_PHONENUMBER    VARCHAR2(11) NOT NULL,
    TRAINER_STATUS         VARCHAR2(20) DEFAULT 'Available' CHECK (TRAINER_STATUS IN ('Available', 'Busy'))
);


CREATE TABLE WORKOUTSESSIONS
(
    SESSIONID       NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    SESSIONNAME     VARCHAR(50) NOT NULL,
    DATEOFSESSION   DATE        NOT NULL,
    MAXPARTICIPANTS NUMBER(3) CHECK (MAXPARTICIPANTS > 0),
    AVAILABLESPOTS  NUMBER(3) CHECK (AVAILABLESPOTS >= 0),
    TRAINERID       NUMBER      NOT NULL,
    CONSTRAINT FK_TRAINER FOREIGN KEY (TRAINERID) REFERENCES TRAINERS (TRAINERID)
);

CREATE TABLE PLANNED_WORKOUTS (
    PLANNEDWORKOUTID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    CUSTOMERID NUMBER NOT NULL,
    TRAINERID NUMBER NOT NULL,
    WORKOUTTYPE VARCHAR2(50) NOT NULL,
    SESSIONDATE DATE NOT NULL,
    CONSTRAINT FK_CUSTOMER_PLANNEDWORKOUT FOREIGN KEY (CUSTOMERID) REFERENCES CUSTOMERS(CUSTOMERID),
    CONSTRAINT FK_TRAINER_PLANNEDWORKOUT FOREIGN KEY (TRAINERID) REFERENCES TRAINERS(TRAINERID)
);